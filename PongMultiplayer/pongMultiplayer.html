<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Pong Multiplayer</title>
    <style>
        * { padding: 0; margin: 0; }
        canvas {
            background: rgba(255, 255, 255, 0); 
            display: block; 
            margin: auto; 
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
        }
        /* div {
            
            background-color: #8a995a;
            background-image: url("https://www.transparenttextures.com/patterns/white-diamond-dark.png ");
            
            https://www.transparenttextures.com/patterns/diagmonds.png
            https://www.transparenttextures.com/patterns/white-diamond-dark.png 
            https://www.svgbackgrounds.com/#rainbow-vortex
            
            


        }
         */
        body {
            
            background-color: #8a995a00;
            background-image: url("https://www.transparenttextures.com/patterns/white-diamond-dark.png");
            
            /*
            background-color: #ff7700;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1600 900'%3E%3Cpolygon fill='%23cc0000' points='957 450 539 900 1396 900'/%3E%3Cpolygon fill='%23aa0000' points='957 450 872.9 900 1396 900'/%3E%3Cpolygon fill='%23d6002b' points='-60 900 398 662 816 900'/%3E%3Cpolygon fill='%23b10022' points='337 900 398 662 816 900'/%3E%3Cpolygon fill='%23d9004b' points='1203 546 1552 900 876 900'/%3E%3Cpolygon fill='%23b2003d' points='1203 546 1552 900 1162 900'/%3E%3Cpolygon fill='%23d3006c' points='641 695 886 900 367 900'/%3E%3Cpolygon fill='%23ac0057' points='587 900 641 695 886 900'/%3E%3Cpolygon fill='%23c4008c' points='1710 900 1401 632 1096 900'/%3E%3Cpolygon fill='%239e0071' points='1710 900 1401 632 1365 900'/%3E%3Cpolygon fill='%23aa00aa' points='1210 900 971 687 725 900'/%3E%3Cpolygon fill='%23880088' points='943 900 1210 900 971 687'/%3E%3C/svg%3E");
            background-attachment: fixed;
            background-size: cover;
            
            
            background-color: #ff9d00;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100%25' height='100%25' viewBox='0 0 1600 800'%3E%3Cg stroke='%23000' stroke-width='66.7' stroke-opacity='0.05' %3E%3Ccircle fill='%23ff9d00' cx='0' cy='0' r='1800'/%3E%3Ccircle fill='%23fb8d17' cx='0' cy='0' r='1700'/%3E%3Ccircle fill='%23f47d24' cx='0' cy='0' r='1600'/%3E%3Ccircle fill='%23ed6e2d' cx='0' cy='0' r='1500'/%3E%3Ccircle fill='%23e35f34' cx='0' cy='0' r='1400'/%3E%3Ccircle fill='%23d85239' cx='0' cy='0' r='1300'/%3E%3Ccircle fill='%23cc453e' cx='0' cy='0' r='1200'/%3E%3Ccircle fill='%23be3941' cx='0' cy='0' r='1100'/%3E%3Ccircle fill='%23b02f43' cx='0' cy='0' r='1000'/%3E%3Ccircle fill='%23a02644' cx='0' cy='0' r='900'/%3E%3Ccircle fill='%23901e44' cx='0' cy='0' r='800'/%3E%3Ccircle fill='%23801843' cx='0' cy='0' r='700'/%3E%3Ccircle fill='%236f1341' cx='0' cy='0' r='600'/%3E%3Ccircle fill='%235e0f3d' cx='0' cy='0' r='500'/%3E%3Ccircle fill='%234e0c38' cx='0' cy='0' r='400'/%3E%3Ccircle fill='%233e0933' cx='0' cy='0' r='300'/%3E%3Ccircle fill='%232e062c' cx='0' cy='0' r='200'/%3E%3Ccircle fill='%23210024' cx='0' cy='0' r='100'/%3E%3C/g%3E%3C/svg%3E");
            background-attachment: fixed;
            background-size: cover;
            */
        }

        .animated-shape {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' version='1.1' xmlns:xlink='http://www.w3.org/1999/xlink' xmlns:svgjs='http://svgjs.com/svgjs' width='1000' height='1000' preserveAspectRatio='none' viewBox='0 0 1000 1000'%3e%3cg mask='url(%26quot%3b%23SvgjsMask1093%26quot%3b)' fill='none'%3e%3crect width='1000' height='1000' x='0' y='0' fill='rgba(150%2c 194%2c 235%2c 0.53)'%3e%3c/rect%3e%3cpath d='M991.811889037265 467.8219084933171L713.8753527504389 433.695592926465 957.6855734704129 745.7584447801432z' fill='rgba(138%2c 187%2c 240%2c 0.4)' class='triangle-float3'%3e%3c/path%3e%3cpath d='M464.67894358224703 695.2797814138509L517.3212709843309 879.5279273211441 635.7665076390194 761.0826906664556z' fill='rgba(138%2c 187%2c 240%2c 0.4)' class='triangle-float1'%3e%3c/path%3e%3cpath d='M278.99090099200413 235.21441518967822L442.0048996354609 362.57490924919665 569.3653936949793 199.56091060573985 406.35139505152256 72.20041654622142z' fill='rgba(138%2c 187%2c 240%2c 0.4)' class='triangle-float3'%3e%3c/path%3e%3cpath d='M206.187%2c319.856C238.948%2c320.25%2c270.466%2c306.666%2c288.418%2c279.259C308.305%2c248.898%2c317.343%2c209.514%2c298.964%2c178.218C280.757%2c147.216%2c242.139%2c138.986%2c206.187%2c139.238C170.782%2c139.486%2c133.193%2c148.757%2c115.632%2c179.501C98.175%2c210.063%2c108.233%2c247.745%2c127.314%2c277.32C144.671%2c304.222%2c174.174%2c319.471%2c206.187%2c319.856' fill='rgba(138%2c 187%2c 240%2c 0.4)' class='triangle-float1'%3e%3c/path%3e%3c/g%3e%3cdefs%3e%3cmask id='SvgjsMask1093'%3e%3crect width='1000' height='1000' fill='white'%3e%3c/rect%3e%3c/mask%3e%3cstyle%3e %40keyframes float1 %7b 0%25%7btransform: translate(0%2c 0)%7d 50%25%7btransform: translate(-10px%2c 0)%7d 100%25%7btransform: translate(0%2c 0)%7d %7d .triangle-float1 %7b animation: float1 5s infinite%3b %7d %40keyframes float2 %7b 0%25%7btransform: translate(0%2c 0)%7d 50%25%7btransform: translate(-5px%2c -5px)%7d 100%25%7btransform: translate(0%2c 0)%7d %7d .triangle-float2 %7b animation: float2 4s infinite%3b %7d %40keyframes float3 %7b 0%25%7btransform: translate(0%2c 0)%7d 50%25%7btransform: translate(0%2c -10px)%7d 100%25%7btransform: translate(0%2c 0)%7d %7d .triangle-float3 %7b animation: float3 6s infinite%3b %7d %3c/style%3e%3c/defs%3e%3c/svg%3e");
        }
        .meteor {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' version='1.1' xmlns:xlink='http://www.w3.org/1999/xlink' xmlns:svgjs='http://svgjs.com/svgjs' width='2000' height='2000' preserveAspectRatio='none' viewBox='0 0 2000 2000'%3e%3cg mask='url(%26quot%3b%23SvgjsMask1012%26quot%3b)' fill='none'%3e%3crect width='2000' height='2000' x='0' y='0' fill='rgba(150%2c 194%2c 235%2c 0.53)'%3e%3c/rect%3e%3cpath d='M510 1425L509 2721' stroke-width='6' stroke='url(%23SvgjsLinearGradient1013)' stroke-linecap='round' class='Up'%3e%3c/path%3e%3cpath d='M420 1464L419 2134' stroke-width='10' stroke='url(%23SvgjsLinearGradient1013)' stroke-linecap='round' class='Up'%3e%3c/path%3e%3cpath d='M862 151L861 1298' stroke-width='8' stroke='url(%23SvgjsLinearGradient1014)' stroke-linecap='round' class='Down'%3e%3c/path%3e%3cpath d='M698 584L697 1639' stroke-width='10' stroke='url(%23SvgjsLinearGradient1013)' stroke-linecap='round' class='Up'%3e%3c/path%3e%3cpath d='M1934 1480L1933 2535' stroke-width='6' stroke='url(%23SvgjsLinearGradient1013)' stroke-linecap='round' class='Up'%3e%3c/path%3e%3cpath d='M1908 616L1907 2092' stroke-width='8' stroke='url(%23SvgjsLinearGradient1013)' stroke-linecap='round' class='Up'%3e%3c/path%3e%3cpath d='M72 390L71 1684' stroke-width='10' stroke='url(%23SvgjsLinearGradient1014)' stroke-linecap='round' class='Down'%3e%3c/path%3e%3cpath d='M1320 972L1319 154' stroke-width='8' stroke='url(%23SvgjsLinearGradient1014)' stroke-linecap='round' class='Down'%3e%3c/path%3e%3cpath d='M364 1431L363 213' stroke-width='8' stroke='url(%23SvgjsLinearGradient1013)' stroke-linecap='round' class='Up'%3e%3c/path%3e%3cpath d='M1464 1952L1463 2979' stroke-width='10' stroke='url(%23SvgjsLinearGradient1013)' stroke-linecap='round' class='Up'%3e%3c/path%3e%3cpath d='M370 1642L369 315' stroke-width='6' stroke='url(%23SvgjsLinearGradient1013)' stroke-linecap='round' class='Up'%3e%3c/path%3e%3cpath d='M1217 1543L1216 2751' stroke-width='6' stroke='url(%23SvgjsLinearGradient1013)' stroke-linecap='round' class='Up'%3e%3c/path%3e%3cpath d='M942 1555L941 783' stroke-width='8' stroke='url(%23SvgjsLinearGradient1014)' stroke-linecap='round' class='Down'%3e%3c/path%3e%3cpath d='M1629 387L1628 -1113' stroke-width='8' stroke='url(%23SvgjsLinearGradient1013)' stroke-linecap='round' class='Up'%3e%3c/path%3e%3cpath d='M1914 1727L1913 861' stroke-width='8' stroke='url(%23SvgjsLinearGradient1013)' stroke-linecap='round' class='Up'%3e%3c/path%3e%3cpath d='M948 279L947 -579' stroke-width='6' stroke='url(%23SvgjsLinearGradient1013)' stroke-linecap='round' class='Up'%3e%3c/path%3e%3cpath d='M1756 1409L1755 2387' stroke-width='6' stroke='url(%23SvgjsLinearGradient1014)' stroke-linecap='round' class='Down'%3e%3c/path%3e%3cpath d='M1722 770L1721 2161' stroke-width='10' stroke='url(%23SvgjsLinearGradient1014)' stroke-linecap='round' class='Down'%3e%3c/path%3e%3cpath d='M1953 876L1952 -430' stroke-width='8' stroke='url(%23SvgjsLinearGradient1014)' stroke-linecap='round' class='Down'%3e%3c/path%3e%3cpath d='M1416 222L1415 -767' stroke-width='8' stroke='url(%23SvgjsLinearGradient1014)' stroke-linecap='round' class='Down'%3e%3c/path%3e%3cpath d='M1961 263L1960 -288' stroke-width='6' stroke='url(%23SvgjsLinearGradient1014)' stroke-linecap='round' class='Down'%3e%3c/path%3e%3cpath d='M1122 548L1121 1393' stroke-width='8' stroke='url(%23SvgjsLinearGradient1013)' stroke-linecap='round' class='Up'%3e%3c/path%3e%3cpath d='M744 825L743 -632' stroke-width='8' stroke='url(%23SvgjsLinearGradient1013)' stroke-linecap='round' class='Up'%3e%3c/path%3e%3cpath d='M1060 1205L1059 2495' stroke-width='8' stroke='url(%23SvgjsLinearGradient1014)' stroke-linecap='round' class='Down'%3e%3c/path%3e%3cpath d='M272 1374L271 293' stroke-width='10' stroke='url(%23SvgjsLinearGradient1014)' stroke-linecap='round' class='Down'%3e%3c/path%3e%3cpath d='M1012 163L1011 1410' stroke-width='10' stroke='url(%23SvgjsLinearGradient1013)' stroke-linecap='round' class='Up'%3e%3c/path%3e%3cpath d='M872 1445L871 2526' stroke-width='6' stroke='url(%23SvgjsLinearGradient1014)' stroke-linecap='round' class='Down'%3e%3c/path%3e%3cpath d='M1160 525L1159 1937' stroke-width='10' stroke='url(%23SvgjsLinearGradient1013)' stroke-linecap='round' class='Up'%3e%3c/path%3e%3cpath d='M398 1817L397 1065' stroke-width='6' stroke='url(%23SvgjsLinearGradient1013)' stroke-linecap='round' class='Up'%3e%3c/path%3e%3cpath d='M276 878L275 -70' stroke-width='8' stroke='url(%23SvgjsLinearGradient1014)' stroke-linecap='round' class='Down'%3e%3c/path%3e%3cpath d='M1762 23L1761 1427' stroke-width='8' stroke='url(%23SvgjsLinearGradient1013)' stroke-linecap='round' class='Up'%3e%3c/path%3e%3cpath d='M556 235L555 851' stroke-width='6' stroke='url(%23SvgjsLinearGradient1014)' stroke-linecap='round' class='Down'%3e%3c/path%3e%3cpath d='M722 1837L721 1116' stroke-width='8' stroke='url(%23SvgjsLinearGradient1013)' stroke-linecap='round' class='Up'%3e%3c/path%3e%3cpath d='M886 1198L885 1802' stroke-width='6' stroke='url(%23SvgjsLinearGradient1014)' stroke-linecap='round' class='Down'%3e%3c/path%3e%3cpath d='M518 1180L517 79' stroke-width='8' stroke='url(%23SvgjsLinearGradient1014)' stroke-linecap='round' class='Down'%3e%3c/path%3e%3cpath d='M1944 1877L1943 3327' stroke-width='10' stroke='url(%23SvgjsLinearGradient1014)' stroke-linecap='round' class='Down'%3e%3c/path%3e%3cpath d='M647 1791L646 2665' stroke-width='6' stroke='url(%23SvgjsLinearGradient1013)' stroke-linecap='round' class='Up'%3e%3c/path%3e%3cpath d='M1811 830L1810 -438' stroke-width='8' stroke='url(%23SvgjsLinearGradient1013)' stroke-linecap='round' class='Up'%3e%3c/path%3e%3cpath d='M160 1616L159 730' stroke-width='10' stroke='url(%23SvgjsLinearGradient1013)' stroke-linecap='round' class='Up'%3e%3c/path%3e%3cpath d='M598 320L597 835' stroke-width='8' stroke='url(%23SvgjsLinearGradient1013)' stroke-linecap='round' class='Up'%3e%3c/path%3e%3cpath d='M1551 1335L1550 835' stroke-width='8' stroke='url(%23SvgjsLinearGradient1014)' stroke-linecap='round' class='Down'%3e%3c/path%3e%3cpath d='M527 1542L526 2627' stroke-width='8' stroke='url(%23SvgjsLinearGradient1013)' stroke-linecap='round' class='Up'%3e%3c/path%3e%3cpath d='M709 1044L708 -88' stroke-width='10' stroke='url(%23SvgjsLinearGradient1013)' stroke-linecap='round' class='Up'%3e%3c/path%3e%3cpath d='M977 366L976 1602' stroke-width='10' stroke='url(%23SvgjsLinearGradient1014)' stroke-linecap='round' class='Down'%3e%3c/path%3e%3cpath d='M129 1942L128 936' stroke-width='6' stroke='url(%23SvgjsLinearGradient1014)' stroke-linecap='round' class='Down'%3e%3c/path%3e%3cpath d='M846 1329L845 423' stroke-width='6' stroke='url(%23SvgjsLinearGradient1014)' stroke-linecap='round' class='Down'%3e%3c/path%3e%3cpath d='M361 1161L360 1718' stroke-width='8' stroke='url(%23SvgjsLinearGradient1013)' stroke-linecap='round' class='Up'%3e%3c/path%3e%3cpath d='M1626 1112L1625 60' stroke-width='6' stroke='url(%23SvgjsLinearGradient1013)' stroke-linecap='round' class='Up'%3e%3c/path%3e%3cpath d='M260 1275L259 1810' stroke-width='6' stroke='url(%23SvgjsLinearGradient1014)' stroke-linecap='round' class='Down'%3e%3c/path%3e%3cpath d='M1062 668L1061 1313' stroke-width='10' stroke='url(%23SvgjsLinearGradient1014)' stroke-linecap='round' class='Down'%3e%3c/path%3e%3c/g%3e%3cdefs%3e%3cmask id='SvgjsMask1012'%3e%3crect width='2000' height='2000' fill='white'%3e%3c/rect%3e%3c/mask%3e%3clinearGradient x1='0%25' y1='100%25' x2='0%25' y2='0%25' id='SvgjsLinearGradient1013'%3e%3cstop stop-color='rgba(138%2c 187%2c 240%2c 0)' offset='0'%3e%3c/stop%3e%3cstop stop-color='rgba(138%2c 187%2c 240%2c 0.4)' offset='1'%3e%3c/stop%3e%3c/linearGradient%3e%3clinearGradient x1='0%25' y1='0%25' x2='0%25' y2='100%25' id='SvgjsLinearGradient1014'%3e%3cstop stop-color='rgba(138%2c 187%2c 240%2c 0)' offset='0'%3e%3c/stop%3e%3cstop stop-color='rgba(138%2c 187%2c 240%2c 0.4)' offset='1'%3e%3c/stop%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e");        }

        .circles {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' version='1.1' xmlns:xlink='http://www.w3.org/1999/xlink' xmlns:svgjs='http://svgjs.com/svgjs' width='2000' height='2000' preserveAspectRatio='none' viewBox='0 0 2000 2000'%3e%3cg clip-path='url(%26quot%3b%23SvgjsClipPath1002%26quot%3b)' fill='none'%3e%3crect width='2000' height='2000' x='0' y='0' fill='rgba(150%2c 194%2c 235%2c 0.53)'%3e%3c/rect%3e%3ccircle r='333.335' cx='115.9' cy='203.29' stroke='%238abbf0' stroke-opacity='0.4' stroke-width='2'%3e%3c/circle%3e%3ccircle r='238.605' cx='1176.61' cy='846.33' stroke='%238abbf0' stroke-opacity='0.4' stroke-width='2'%3e%3c/circle%3e%3ccircle r='511.95' cx='1151.59' cy='9.19' stroke='%238abbf0' stroke-opacity='0.4' stroke-width='2'%3e%3c/circle%3e%3ccircle r='471.655' cx='551.23' cy='1245.22' stroke='%238abbf0' stroke-opacity='0.4' stroke-width='2'%3e%3c/circle%3e%3ccircle r='494.36' cx='1427.09' cy='1588.6' stroke='%238abbf0' stroke-opacity='0.4' stroke-width='2'%3e%3c/circle%3e%3ccircle r='600.21' cx='1142.28' cy='474.46' stroke='%238abbf0' stroke-opacity='0.4' stroke-width='2'%3e%3c/circle%3e%3ccircle r='579.38' cx='593.9' cy='1862.75' stroke='%238abbf0' stroke-opacity='0.4' stroke-width='2'%3e%3c/circle%3e%3ccircle r='316.72' cx='93.63' cy='1896.7' stroke='%238abbf0' stroke-opacity='0.4' stroke-width='2'%3e%3c/circle%3e%3ccircle r='353.52' cx='564.18' cy='1668.16' stroke='%238abbf0' stroke-opacity='0.4' stroke-width='2'%3e%3c/circle%3e%3ccircle r='601.69' cx='14.55' cy='246.97' stroke='%238abbf0' stroke-opacity='0.4' stroke-width='2'%3e%3c/circle%3e%3ccircle r='452.85' cx='647.52' cy='455.92' stroke='%238abbf0' stroke-opacity='0.4' stroke-width='2'%3e%3c/circle%3e%3ccircle r='372.84' cx='982.7' cy='436.49' stroke='%238abbf0' stroke-opacity='0.4' stroke-width='2'%3e%3c/circle%3e%3ccircle r='497.205' cx='21.7' cy='537.29' stroke='%238abbf0' stroke-opacity='0.4' stroke-width='2'%3e%3c/circle%3e%3ccircle r='644.695' cx='406.48' cy='1669.53' stroke='%238abbf0' stroke-opacity='0.4' stroke-width='2'%3e%3c/circle%3e%3ccircle r='580.55' cx='1861.34' cy='238.43' stroke='%238abbf0' stroke-opacity='0.4' stroke-width='2'%3e%3c/circle%3e%3ccircle r='252.78' cx='663.37' cy='1991.88' stroke='%238abbf0' stroke-opacity='0.4' stroke-width='2'%3e%3c/circle%3e%3ccircle r='205.31' cx='1750.53' cy='1385.23' stroke='%238abbf0' stroke-opacity='0.4' stroke-width='2'%3e%3c/circle%3e%3ccircle r='606.655' cx='385.78' cy='1584.38' stroke='%238abbf0' stroke-opacity='0.4' stroke-width='2'%3e%3c/circle%3e%3ccircle r='310.8' cx='1345.74' cy='544.09' stroke='%238abbf0' stroke-opacity='0.4' stroke-width='2'%3e%3c/circle%3e%3ccircle r='320.225' cx='1974.59' cy='509.18' stroke='%238abbf0' stroke-opacity='0.4' stroke-width='2'%3e%3c/circle%3e%3ccircle r='412.465' cx='429.76' cy='632.12' stroke='%238abbf0' stroke-opacity='0.4' stroke-width='2'%3e%3c/circle%3e%3ccircle r='210.315' cx='987.67' cy='483.27' stroke='%238abbf0' stroke-opacity='0.4' stroke-width='2'%3e%3c/circle%3e%3ccircle r='210.585' cx='885.91' cy='1358.92' stroke='%238abbf0' stroke-opacity='0.4' stroke-width='2'%3e%3c/circle%3e%3ccircle r='568.38' cx='1550.82' cy='2.47' stroke='%238abbf0' stroke-opacity='0.4' stroke-width='2'%3e%3c/circle%3e%3ccircle r='188.325' cx='797.77' cy='357.07' stroke='%238abbf0' stroke-opacity='0.4' stroke-width='2'%3e%3c/circle%3e%3c/g%3e%3cdefs%3e%3cclipPath id='SvgjsClipPath1002'%3e%3crect width='2000' height='2000' x='0' y='0'%3e%3c/rect%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e");        
        }

        .waves {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' version='1.1' xmlns:xlink='http://www.w3.org/1999/xlink' xmlns:svgjs='http://svgjs.com/svgjs' width='2000' height='1250' preserveAspectRatio='none' viewBox='0 0 2000 1250'%3e%3cg mask='url(%26quot%3b%23SvgjsMask1009%26quot%3b)' fill='none'%3e%3cpath d='M 0%2c385 C 100%2c339.6 300%2c133.4 500%2c158 C 700%2c182.6 800%2c516 1000%2c508 C 1200%2c500 1300%2c110.8 1500%2c118 C 1700%2c125.2 1900%2c458.8 2000%2c544L2000 1250L0 1250z' fill='rgba(138%2c 187%2c 240%2c 0.4)'%3e%3c/path%3e%3cpath d='M 0%2c1098 C 100%2c1018.2 300%2c695.6 500%2c699 C 700%2c702.4 800%2c1069 1000%2c1115 C 1200%2c1161 1300%2c927 1500%2c929 C 1700%2c931 1900%2c1085.8 2000%2c1125L2000 1250L0 1250z' fill='rgba(138%2c 187%2c 240%2c 0.4)'%3e%3c/path%3e%3c/g%3e%3cdefs%3e%3cmask id='SvgjsMask1009'%3e%3crect width='2000' height='1250' fill='white'%3e%3c/rect%3e%3c/mask%3e%3c/defs%3e%3c/svg%3e");        }

        .lines {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' version='1.1' xmlns:xlink='http://www.w3.org/1999/xlink' xmlns:svgjs='http://svgjs.com/svgjs' width='2000' height='2000' preserveAspectRatio='none' viewBox='0 0 2000 2000'%3e%3cg mask='url(%26quot%3b%23SvgjsMask1014%26quot%3b)' fill='none'%3e%3crect width='2000' height='2000' x='0' y='0' fill='rgba(150%2c 194%2c 235%2c 0.53)'%3e%3c/rect%3e%3cpath d='M239.13 500C204.66 387.98 51.22 472.95 0 365.85C-68.34 222.95 -105.63 77.29 0 0C144.37 -105.63 250 0 500 0C544.12 0 545.02 -8.07 588.24 0C795.02 38.6 791.33 74.92 1000 93.33C1247.21 115.15 1254.67 112.01 1500 80.46C1617.58 65.34 1609.2 18.77 1725.81 0C1859.2 -21.46 1951.45 -88.54 2000 0C2088.54 161.46 2000 250 2000 500C2000 750 2000 750 2000 1000C2000 1250 2000 1250 2000 1500C2000 1618.42 2077.96 1676.2 2000 1736.84C1827.96 1870.65 1722.47 1944.14 1500 1888.89C1245.62 1825.72 1046.3 1687.06 1046.3 1500C1046.3 1322.47 1286.6 1343.66 1500 1159.72C1576.64 1093.66 1626.37 1075.34 1626.37 1000C1626.37 935.59 1580.89 896.15 1500 880.21C1267.71 834.42 1239.4 836.83 1000 876.54C878.29 896.73 782.94 899.58 777.78 1000C766.92 1211.31 954.88 1246.19 967.95 1500C980.63 1746.19 972.41 1847.06 829.27 2000C738.44 2097.06 664.63 2000 500 2000C250 2000 125 2125 0 2000C-125 1875 0 1750 0 1500C0 1295.97 -63.82 1255.5 0 1091.95C33.74 1005.5 159.18 1088.96 195.12 1000C278.75 792.99 302.22 705.06 239.13 500' stroke='rgba(138%2c 187%2c 240%2c 0.4)' stroke-width='2'%3e%3c/path%3e%3cpath d='M307.02 0C307.02 58.59 97.73 213.41 0 213.41C-55.78 213.41 -62.95 43.76 0 0C90.56 -62.95 307.02 -48.11 307.02 0' stroke='rgba(138%2c 187%2c 240%2c 0.4)' stroke-width='2'%3e%3c/path%3e%3cpath d='M513.51 500C513.51 383.63 743.65 331.69 1000 260C1236.89 193.76 1275.58 160.24 1500 224.14C1697.01 280.24 1678.9 354.05 1842.86 500C1928.9 576.59 1967.7 566.45 2000 669.23C2046.27 816.45 2000 834.62 2000 1000C2000 1182.2 2060.13 1214.09 2000 1364.41C1960.13 1464.09 1901.19 1434.01 1800 1500C1651.19 1597.05 1643.18 1690.48 1500 1690.48C1382.07 1690.48 1277.78 1591.62 1277.78 1500C1277.78 1413.05 1403.97 1432.14 1500 1333.33C1646.95 1182.14 1763.74 1157.24 1763.74 1000C1763.74 865.57 1660.58 808.41 1500 750C1278.71 669.52 1238.51 782.66 1000 722.22C745.26 657.66 513.51 614.74 513.51 500' stroke='rgba(138%2c 187%2c 240%2c 0.4)' stroke-width='2'%3e%3c/path%3e%3cpath d='M0 1235.63C169.11 1066.52 304.16 935.9 500 1000C708.01 1068.08 801.53 1247.33 807.69 1500C813.72 1747.33 671.97 1760.18 524.39 2000C518.13 2010.18 512.19 2000 500 2000C375 2000 374.78 2005.2 250 2000C124.78 1994.78 42.95 2065.08 0 1979.17C-82.05 1815.08 0 1739.59 0 1500C0 1367.82 -80.89 1316.52 0 1235.63' stroke='rgba(138%2c 187%2c 240%2c 0.4)' stroke-width='2'%3e%3c/path%3e%3cpath d='M87.72 0C87.72 16.74 27.92 60.98 0 60.98C-15.94 60.98 -17.99 12.5 0 0C25.87 -17.99 87.72 -13.75 87.72 0' stroke='rgba(138%2c 187%2c 240%2c 0.4)' stroke-width='2'%3e%3c/path%3e%3cpath d='M851.35 500C851.35 464.44 919.67 443.04 1000 426.67C1243.99 376.95 1265.9 341.98 1500 367.82C1598.05 378.64 1664.29 435.86 1664.29 500C1664.29 561.85 1595.65 610.01 1500 619.79C1263.51 643.96 1244.75 613.1 1000 567.9C920.43 553.21 851.35 535.06 851.35 500' stroke='rgba(138%2c 187%2c 240%2c 0.4)' stroke-width='2'%3e%3c/path%3e%3cpath d='M1901.1 1000C1901.1 929.66 1972.74 861.54 2000 861.54C2022.19 861.54 2000 930.77 2000 1000C2000 1076.27 2022.56 1152.54 2000 1152.54C1973.11 1152.54 1901.1 1075.16 1901.1 1000' stroke='rgba(138%2c 187%2c 240%2c 0.4)' stroke-width='2'%3e%3c/path%3e%3cpath d='M0 1379.31C202.46 1282.3 290.79 1221.42 500 1260.42C614.51 1281.77 647.44 1379.52 647.44 1500C647.44 1624.31 618.75 1709.88 500 1750C295.03 1819.25 174.02 1805.76 0 1718.75C-75.98 1680.76 0 1609.38 0 1500C0 1439.65 -47.54 1402.09 0 1379.31' stroke='rgba(138%2c 187%2c 240%2c 0.4)' stroke-width='2'%3e%3c/path%3e%3c/g%3e%3cdefs%3e%3cmask id='SvgjsMask1014'%3e%3crect width='2000' height='2000' fill='white'%3e%3c/rect%3e%3c/mask%3e%3c/defs%3e%3c/svg%3e");             
        }
        
        

       
    </style>
    <link rel="icon" href="extras/icon.png">
    <link rel="shortcut icon" type="image/x-icon" href="extras/icon2.ico" />
    <link rel="shortcut icon" type="image/png" href="extras/icon.png" />
</head>
<body onload="setBackground()">
    
    <div style = "text-align:center;">
        <canvas id="myCanvas" ></canvas>
        <!-- <p>Bottom paddle: arrow keys. Top paddle: A/D. Left paddle: O/L</p>
        <p>Right paddle: -/+.</p>
        Toggle resize: <button onclick="toggleRandomResize()">Resize</button> or spacebar.
        Toggle realtive rebounds: <input type="checkbox" id="myCheckRelative" onclick="checkRealtiveRebounds()" checked="true">
        <p >Ball Pos (x,y): <span id="ballX"></span> <span id="ballY"></span></p>
        <p>Ball velocity (dx,dy): <span id="ballDx"></span> , <span id="ballDy"></span></p>
        <p >Status: <span id="status"></span></p>
        <button onclick="startGame()">Start Game</button> -->
        
    </div>

    <audio controls autoplay hidden>
        <source src="Retro_Arcade.mp3" type="audio/mpeg">
      Your browser does not support the audio element.
      <https://patrickdearteaga.com/arcade-music/>
      <https://www.dl-sounds.com/royalty-free/category/game-film/video-game/?_sfm_bpm=0+220/>
    </audio>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        // Scripts for socket.io
        var socketType = 'game';
        var url = window.location.host;
        var socket = io(url , {
          query: {
            "data" : socketType
          }
        });

        var controllers = [];

        socket.on('controller connection', (id) =>{
            var full;
            var orient;
            if (controllers.length <= 4) {
                if (controllers.length === 1 || controllers.length === 3) orient = 'vertical';
                else orient = 'horizontal';
                full = false;
                controllers.push(id);
            }
            else full = true;
            callback = {
                socket: id,
                isfull: full,
                orientation: orient
            };
            socket.emit('connection callback', callback);
        });

        socket.on('leftOn', (id) =>{
            // Get the controller
            var index = controllers.indexOf(id);
            // Trigger the corresponding controller
            if (index === 0) bottomPaddle.leftPress = true;
            if (index === 2) topPaddle.leftPress = true;
            // Wrong oriented controller triggering
            else console.log("Input from invalid paddle: leftOn");
        });

        socket.on('leftOff', (id) =>{
            // Get the controller
            var index = controllers.indexOf(id);
            // Trigger the corresponding controller
            if (index === 0) bottomPaddle.leftPress = false;
            if (index === 2) topPaddle.leftPress = false;
            // Wrong oriented controller triggering
            else console.log("Input from invalid paddle: leftOff");
        });

        socket.on('rightOn', (id) =>{
            // Get the controller
            var index = controllers.indexOf(id);
            // Trigger the corresponding controller
            if (index === 0) bottomPaddle.rightPress = true;
            if (index === 2) topPaddle.rightPress = true;
            // Wrong oriented controller triggering
            else console.log("Input from invalid paddle: rightOn");
        });

        socket.on('rightOff', (id) =>{
            // Get the controller
            var index = controllers.indexOf(id);
            // Trigger the corresponding controller
            if (index === 0) bottomPaddle.rightPress = false;
            if (index === 2) topPaddle.rightPress = false;
            // Wrong oriented controller triggering
            else console.log("Input from invalid paddle: rightOff");
        });

        socket.on('upOn', (id) =>{
            // Get the controller
            var index = controllers.indexOf(id);
            // Trigger the corresponding controller
            if (index === 1) leftPaddle.upPress = true;
            if (index === 3) rightPaddle.upPress = true;
            // Wrong oriented controller triggering
            else console.log("Input from invalid paddle: upOn");
        });

        socket.on('upOff', (id) =>{
            // Get the controller
            var index = controllers.indexOf(id);
            // Trigger the corresponding controller
            if (index === 1) leftPaddle.upPress = false;
            if (index === 3) rightPaddle.upPress = false;
            // Wrong oriented controller triggering
            else console.log("Input from invalid paddle: upOff");
        });

        socket.on('downOn', (id) =>{
            // Get the controller
            var index = controllers.indexOf(id);
            // Trigger the corresponding controller
            if (index === 1) leftPaddle.downPress = true;
            if (index === 3) rightPaddle.downPress = true;
            // Wrong oriented controller triggering
            else console.log("Input from invalid paddle: downOn");
        });

        socket.on('downOff', (id) =>{
            // Get the controller
            var index = controllers.indexOf(id);
            // Trigger the corresponding controller
            if (index === 1) leftPaddle.downPress = false;
            if (index === 3) rightPaddle.downPress = false;
            // Wrong oriented controller triggering
            else console.log("Input from invalid paddle: downOff");
        });

    </script>

    <script>
        var canvas = document.getElementById("myCanvas");
        var ctx = canvas.getContext("2d");
        ctx.canvas.height = Math.round(Math.round((window.innerHeight*2/3))/10)*10;
        ctx.canvas.width = Math.round(Math.round((window.innerHeight*2/3))/10)*10;
        var gameStarted = false;
        var gameOver = false;

        //Global ball attributes
        var ballSpeed = 2;  
        var defaultBallSpeed = ballSpeed;
        var ballRadius = 10;
        var paddleSpeed = 10;   //Note: paddle speed can only be 2, 5 or 10
        var speedRatio = Math.sqrt((ballSpeed*ballSpeed) + (ballSpeed*ballSpeed));
        var rand;
        var randAngleToggle = false;
        var relativeAngleReboundToggle = true;
        var randResizeToggle = false;
        var resizeAmount = 200;
        var resizeTick = resizeAmount;
        var resizePerTick = 1;
        var canvasSizeIncrease = false;
        var paddleHeight = 10;
        var paddleWidth = 70;   
        var defaultPaddleWidth = 70; //Note: must be multiple of 10
        var borderWidth = Math.round(Math.round(0.1 * canvas.width)/10)*10; //Round to whole number and round to nearest 10

        // Colours
        // https://www.reddit.com/r/coolguides/comments/njqt0x/color_combinations_that_go_well_with_each_other/

        // Sounds
        // https://www.zapsplat.com/sound-effect-category/game-sounds/page/12/

        // Balls
        var ball1 = {
            x: canvas.width*4/5,
            y: canvas.height/2,
            dx: -ballSpeed,
            dy: ballSpeed,
            colour: "#000000",
            owner: 'none',
            initialPos: true
        };

        var ball2 = {
            x: canvas.width*4/5,
            y: canvas.height/2,
            dx: -ballSpeed,
            dy: ballSpeed,
            colour: "#000000",
            owner: 'none',
            initialPos: false
        };

        //Powerups
        var powerup1 = {
            x: 10,
            y: 10,
            size: borderWidth/2,
            active: false,
            colourCounter: 10,
            colour: "#000000"
        };

        var powerup2 = {
            x: 10,
            y: 10,
            size: borderWidth/2,
            active: false,
            colourCounter: 10,
            colour: "#000000"
        };

        // Paddles
        var topPaddle = {
            x: Math.round(Math.round(((canvas.width/2)-(defaultPaddleWidth/2)))/10)*10,
            y: (canvas.height-defaultPaddleWidth)/2,
            width: defaultPaddleWidth,
            leftPress: false,
            rightPress: false,
            lives: 2,
            colour: "#FC1212"
        }

        var leftPaddle = {
            x: (canvas.width-defaultPaddleWidth)/2,
            y: Math.round(Math.round(((canvas.height-defaultPaddleWidth)/2))/10)*10,
            width: defaultPaddleWidth,
            upPress: false,
            downPress: false,
            lives: 2,
            colour: "#3CC01B"
        }

        var rightPaddle = {
            x: (canvas.width-defaultPaddleWidth)/2,
            y: Math.round(Math.round(((canvas.height-defaultPaddleWidth)/2))/10)*10,
            width: defaultPaddleWidth,
            upPress: false,
            downPress: false,
            lives: 2,
            colour: "#C072CC"
        }
        
        var bottomPaddle = {
            x: Math.round(Math.round(((canvas.width/2)-(defaultPaddleWidth/2)))/10)*10,
            y: ((canvas.height-defaultPaddleWidth)/2),
            width: defaultPaddleWidth,
            leftPress: false,
            rightPress: false,
            lives: 2,
            colour: "#0095DD"
        }
        

        //////////////////////////////////////////////////////// FUNCTIONS ///////////////////////////////////////////////////////

        function startGame() {
            if(gameStarted == false) {     
                var music = new Audio("Sounds/thinking-music.mp3");
                music.loop = true;
                music.play();
                drawCountdown();
                setInterval(() => { gameStarted = true; }, 3000);
                
            }
            
        }

        function setBackground() {
            var num = Math.floor(Math.random() * 4);  //0 - 4
            if(num == 0) {
                // var link = document.getElementsById("lnk"); //Fetch the link by its ID
                // link.setAttribute("body", ".bg-flat-mountains"); //Change its href attribute
                document.body.className = "animated-shape";
            }
            else if(num == 1) {
                document.body.className = "meteor";
                
            }
            else if(num == 2) {
                document.body.className = "circles";

                
            }
            else if(num == 3) {
                document.body.className = "waves";
                
            }
            else if(num == 4) {
                document.body.className = "lines";
                
            }
        }

        function checkRealtiveRebounds() {
            //toggle checkbox
            var checkBoxRealtive = document.getElementById("myCheckRelative");
            relativeAngleReboundToggle = checkBoxRealtive.checked;
        }

        function toggleRandomResize() {
            randResizeToggle = true;
        }

        function resizeCanvas() {

            
            if(resizeTick > 0 && canvasSizeIncrease == false) {
                ctx.canvas.width -= resizePerTick;
                ctx.canvas.height -= resizePerTick;
                //draw(); 
                resizeTick -= 1;
                setTimeout(resizeCanvas, 10);
            }
            else if (resizeTick < resizeAmount){
                canvasSizeIncrease = true;
                ctx.canvas.width += resizePerTick;
                ctx.canvas.height += resizePerTick;
                // draw();
                resizeTick += 1;
                if(resizeTick == resizeAmount) return;
                setTimeout(resizeCanvas, 10);
                
            }
            else {
                canvasSizeIncrease = false;
            }
            
        }


        document.addEventListener("keydown", keyDownHandler, false);
        document.addEventListener("keyup", keyUpHandler, false);
        document.addEventListener("mousemove", mouseMoveHandler, false);

        function keyDownHandler(e) {
            //Bottom player
            if(e.key == "Right" || e.key == "ArrowRight") {
                bottomPaddle.rightPress = true;
            }
            
            else if(e.key == "Left" || e.key == "ArrowLeft") {
                bottomPaddle.leftPress = true;
            }

            //Top player
            if(e.key == "a") {
                topPaddle.leftPress = true;
            }       
            else if(e.key == "d") {
                topPaddle.rightPress = true;
            }

            //Left player
            if(e.key == "o") {
                leftPaddle.upPress = true;
            }
            else if(e.key == "l") {
                leftPaddle.downPress = true;
            }

            //Right player
            if(e.key == "-" ) {
                rightPaddle.upPress = true;
            }
            else if(e.key == "+") {
                rightPaddle.downPress = true;
            }

            //Manual start game
            if(e.key == " " ) {
                startGame();
            }
        }

        function keyUpHandler(e) {
            //Bottom player
            if(e.key == "Right" || e.key == "ArrowRight") {
                bottomPaddle.rightPress = false;
            }
            else if(e.key == "Left" || e.key == "ArrowLeft") {
                bottomPaddle.leftPress = false;
            }

            //Top player
            if(e.key == "a") {
                topPaddle.leftPress = false;
            }       
            else if(e.key == "d") {
                topPaddle.rightPress = false;
            }

            //Left player
            if(e.key == "o") {
                leftPaddle.upPress = false;
            }
            else if(e.key == "l") {
                leftPaddle.downPress = false;
            }

            //Right player
            if(e.key == "-" ) {
                rightPaddle.upPress = false;
            }
            else if(e.key == "+") {
                rightPaddle.downPress = false;
            }

            // if(e.key == " " ) {
            //     randResizeToggle = false;
            // }
        }
        

        function mouseMoveHandler(e) {
            var relativeX = e.clientX - canvas.offsetLeft;
            var relativeY = e.clientY - canvas.offsetTop;
            if(relativeX > 0 && relativeX < canvas.width) {
                //document.getElementById("xPosMouse").innerHTML = relativeX;
                bottomPaddle.x = Math.round(Math.round(relativeX - bottomPaddle.width/2)/10)*10;
                topPaddle.x = Math.round(Math.round(relativeX - topPaddle.width/2)/10)*10;
                
                

            }
            if(relativeY > 0 && relativeY < canvas.height) {
                //document.getElementById("yPosMouse").innerHTML = relativeY;
                leftPaddle.y = Math.round(Math.round(relativeY - leftPaddle.width/2)/10)*10;
                rightPaddle.y = Math.round(Math.round(relativeY - rightPaddle.width/2)/10)*10;
            }
        }

        function getRandomArbitrary(min, max) {
            return Math.random() * (max - min) + min;
        }

        function checkWinner() {
            var size = borderWidth;
            ctx.fillStyle = "steelblue";
            var font = size + "px verdana";
            ctx.font = font;
            ctx.textAlign = "center";
            

            if(topPaddle.lives > 0 && leftPaddle.lives == 0 && rightPaddle.lives == 0 && bottomPaddle.lives == 0) {
                ctx.clearRect(0, 0, canvas.height, canvas.height);
                ctx.fillStyle = topPaddle.colour;
                ctx.fillText('Red Wins!', canvas.width/2, canvas.height/2);
                gameOver = true;
                gameStarted = false;
            }
            else if(leftPaddle.lives > 0 && topPaddle.lives == 0 && rightPaddle.lives == 0 && bottomPaddle.lives == 0) {
                ctx.clearRect(0, 0, canvas.height, canvas.height);
                ctx.fillStyle = leftPaddle.colour;
                ctx.fillText('Green Wins!', canvas.width/2, canvas.height/2);
                gameOver = true;
                gameStarted = false;


            }
            else if(rightPaddle.lives > 0 && leftPaddle.lives == 0 && topPaddle.lives == 0 && bottomPaddle.lives == 0) {
                ctx.clearRect(0, 0, canvas.height, canvas.height);
                ctx.fillStyle = rightPaddle.colour;
                ctx.fillText('Purple Wins!', canvas.width/2, canvas.height/2);
                gameOver = true;
                gameStarted = false;


            }
            else if(bottomPaddle.lives > 0 && leftPaddle.lives == 0 && rightPaddle.lives == 0 && topPaddle.lives == 0) {
                ctx.clearRect(0, 0, canvas.height, canvas.height);
                ctx.fillStyle = bottomPaddle.colour;
                ctx.fillText('Blue Wins!', canvas.width/2, canvas.height/2);
                gameOver = true;
                gameStarted = false;


            }
        }

        function drawCountdown() {
            var music = new Audio("Sounds/countdown.mp3");
            music.play();

            var size = borderWidth;
            var font = size + "px verdana";
            ctx.font = font;
            ctx.textAlign = "center";
            ctx.fillText('Ready!', canvas.width/2, canvas.height/2);

            setTimeout(() => {
                ctx.clearRect(0, 0, canvas.height, canvas.height);
                ctx.fillText('Set!', canvas.width/2, canvas.height/2);
            }, 1000)

            setTimeout(() => {
                ctx.clearRect(0, 0, canvas.height, canvas.height);
                ctx.fillText('GO!', canvas.width/2, canvas.height/2);
            }, 2000)

        }
        
        function drawBorder() {
            ctx.beginPath();
            ctx.rect(borderWidth, borderWidth, canvas.width - 2*borderWidth, canvas.height - 2*borderWidth);
            ctx.fillStyle = "#000000";
            ctx.stroke();
            ctx.closePath();
        }

        function drawBall(ball) {

            //Have ball start in a random direction
            if(ball.initialPos == true) {

                ball.dx = getRandomArbitrary(0, speedRatio) * (Math.round(Math.random()) * 2 - 1);          
                ball.dy = Math.sqrt(speedRatio*speedRatio - ball.dx*ball.dx) * (Math.round(Math.random()) * 2 - 1);
                ball.x = canvas.height/2;
                ball.y = canvas.height/2;
            }
            ball.initialPos = false;
            ctx.beginPath();
            ctx.arc(ball.x, ball.y, ballRadius, 0, Math.PI*2);
            ctx.fillStyle = ball.colour;
            ctx.fill();
            ctx.closePath();

            ctx.beginPath();
            ctx.arc(ball.x, ball.y, ballRadius, 0, Math.PI*2);
            ctx.stroke();
            ctx.closePath();

        }

        function drawPowerup(powerup) {
            if(powerup.active == false) {
                //Set coords
                powerup.x = getRandomArbitrary(2*borderWidth, canvas.height - 2*borderWidth);
                powerup.y = getRandomArbitrary(2*borderWidth, canvas.height - 2*borderWidth);

                powerup.active = true;
                
            }
            
            var randomColor;
            if(powerup.colourCounter == 10) {
                randomColor = Math.floor(Math.random()*16777215).toString(16);
                powerup.colour = "#" + randomColor;
                powerup.colourCounter = 0;
            }
            ctx.fillStyle = powerup.colour;
            ctx.fillRect(powerup.x, powerup.y, powerup.size, powerup.size);   
            powerup.colourCounter++;      

            ctx.beginPath();
            ctx.rect(powerup.x, powerup.y, powerup.size, powerup.size);
            ctx.fillStyle = "#000000";
            ctx.stroke();
            ctx.closePath();

            var size = powerup.size + 4;
            var font = size + "px verdana";
            ctx.font = font;
            ctx.textAlign = "center";
            ctx.fillText('?', powerup.x + powerup.size/2, powerup.y + powerup.size - 2);
            
        }

        function givePowerup(ball) {
            //Get the owner
            var owner;
            //alert(ball.owner);
            if(ball.owner == 'top') {
                deployPowerup(topPaddle);
            }
            else if (ball.owner == 'left') {
                deployPowerup(leftPaddle);
            }
            else if (ball.owner == 'right') {
                deployPowerup(rightPaddle);
            }
            else if (ball.owner == 'bottom') {
                deployPowerup(bottomPaddle);
            }
            else return;

            
            
        }

        function deployPowerup(paddle) {
            //Pick a random powerup
            var rand = Math.floor(Math.random() * 4);  //0 - 4

            if(rand == 0) { //Make paddle bigger
                if(paddle.width < 2*defaultPaddleWidth) paddle.width *= 2;              
            }
            else if(rand == 1) {    //Make paddle smaller
                if(paddle.width > defaultPaddleWidth/2) paddle.width /= 2;
                
            }
            else if(rand == 2) {    //Give player an extra life
                if(paddle.lives < 3 && paddle.lives > 0) paddle.lives++;
            }
            else if(rand == 3) {    //Make ball faster
                if(ball1.ballSpeed < 2*defaultBallSpeed) {
                    ball1.ballSpeed *= 2;
                    speedRatio = Math.sqrt((ball1.ballSpeed*ball1.ballSpeed) + (ball1.ballSpeed*ball1.ballSpeed));
                }
                
            }
            else if(rand == 4) {    //

            }
        }

        function drawLives() {
            var height = borderWidth/3;
            var gap = height/2;
            var lives = 0;

            // ctx.beginPath();
            // ctx.moveTo(canvas.width/2, 0);
            // ctx.lineTo(canvas.width/2, canvas.height);
            // ctx.stroke();
            // ctx.closePath();

            // ctx.beginPath();
            // ctx.moveTo(0, canvas.height/2);
            // ctx.lineTo(canvas.width, canvas.height/2);
            // ctx.stroke();
            // ctx.closePath();

            // lives = topPaddle.lives;
            // for(var i = 0; i <topPaddle.lives; i++) {
            //     ctx.beginPath();
            //     ctx.arc(canvas.width/2 + i*(gap+height), height, height/2, 0, Math.PI*2);
            //     ctx.fillStyle = topPaddle.colour;
            //     ctx.fill();
            //     ctx.stroke();
            //     ctx.closePath();
            // }

            //Top
            if(topPaddle.lives > 2) {
                ctx.beginPath();
                ctx.arc(canvas.width/2 - 2*height, height, height/2, 0, Math.PI*2);
                ctx.fillStyle = topPaddle.colour;
                ctx.fill();
                ctx.stroke();
                ctx.closePath();

                ctx.beginPath();
                ctx.arc(canvas.width/2, height, height/2, 0, Math.PI*2);
                ctx.fillStyle = topPaddle.colour;
                ctx.fill();
                ctx.stroke();
                ctx.closePath();

                ctx.beginPath();
                ctx.arc(canvas.width/2 + 2*height, height, height/2, 0, Math.PI*2);
                ctx.fillStyle = topPaddle.colour;
                ctx.fill();
                ctx.stroke();
                ctx.closePath();
            }
            else if(topPaddle.lives > 1) {
                ctx.beginPath();
                ctx.arc(canvas.width/2 - height, height, height/2, 0, Math.PI*2);
                ctx.fillStyle = topPaddle.colour;
                ctx.fill();
                ctx.stroke();
                ctx.closePath();

                ctx.beginPath();
                ctx.arc(canvas.width/2 + height, height, height/2, 0, Math.PI*2);
                ctx.fillStyle = topPaddle.colour;
                ctx.fill();
                ctx.stroke();
                ctx.closePath();
            }
            else if(topPaddle.lives > 0) {
                ctx.beginPath();
                ctx.arc(canvas.width/2, height, height/2, 0, Math.PI*2);
                ctx.fillStyle = topPaddle.colour;
                ctx.fill();
                ctx.stroke();
                ctx.closePath();
            }

            //Left
            if (leftPaddle.lives > 2) {
                ctx.beginPath();
                ctx.arc(height, canvas.height/2 - 2*height, height/2, 0, Math.PI*2);
                ctx.fillStyle = leftPaddle.colour;
                ctx.fill();
                ctx.stroke();
                ctx.closePath();

                ctx.beginPath();
                ctx.arc(height, canvas.height/2, height/2, 0, Math.PI*2);
                ctx.fillStyle = leftPaddle.colour;
                ctx.fill();
                ctx.stroke();
                ctx.closePath();

                ctx.beginPath();
                ctx.arc(height, canvas.height/2 + 2*height, height/2, 0, Math.PI*2);
                ctx.fillStyle = leftPaddle.colour;
                ctx.fill();
                ctx.stroke();
                ctx.closePath();
            }
            else if(leftPaddle.lives > 1) {
                ctx.beginPath();
                ctx.arc(height, canvas.height/2 - height, height/2, 0, Math.PI*2);
                ctx.fillStyle = leftPaddle.colour;
                ctx.fill();
                ctx.stroke();
                ctx.closePath();

                ctx.beginPath();
                ctx.arc(height, canvas.height/2 + height, height/2, 0, Math.PI*2);
                ctx.fillStyle = leftPaddle.colour;
                ctx.fill();
                ctx.stroke();
                ctx.closePath();
            }
            else if(leftPaddle.lives > 0) {
                ctx.beginPath();
                ctx.arc(height, canvas.height/2, height/2, 0, Math.PI*2);
                ctx.fillStyle = leftPaddle.colour;
                ctx.fill();
                ctx.stroke();
                ctx.closePath();
            }

            //Right
            if (rightPaddle.lives > 2) {
                ctx.beginPath();
                ctx.arc(canvas.width - height, canvas.height/2 - 2*height, height/2, 0, Math.PI*2);
                ctx.fillStyle = rightPaddle.colour;
                ctx.fill();
                ctx.stroke();
                ctx.closePath();

                ctx.beginPath();
                ctx.arc(canvas.width - height, canvas.height/2, height/2, 0, Math.PI*2);
                ctx.fillStyle = rightPaddle.colour;
                ctx.fill();
                ctx.stroke();
                ctx.closePath();

                ctx.beginPath();
                ctx.arc(canvas.width - height, canvas.height/2 + 2*height, height/2, 0, Math.PI*2);
                ctx.fillStyle = rightPaddle.colour;
                ctx.fill();
                ctx.stroke();
                ctx.closePath();
            }
            else if(rightPaddle.lives > 1) {
                ctx.beginPath();
                ctx.arc(canvas.width - height, canvas.height/2 - height, height/2, 0, Math.PI*2);
                ctx.fillStyle = rightPaddle.colour;
                ctx.fill();
                ctx.stroke();
                ctx.closePath();

                ctx.beginPath();
                ctx.arc(canvas.width - height, canvas.height/2 + height, height/2, 0, Math.PI*2);
                ctx.fillStyle = rightPaddle.colour;
                ctx.fill();
                ctx.stroke();
                ctx.closePath();
            }
            else if(rightPaddle.lives > 0) {
                ctx.beginPath();
                ctx.arc(canvas.width - height, canvas.height/2, height/2, 0, Math.PI*2);
                ctx.fillStyle = rightPaddle.colour;
                ctx.fill();
                ctx.stroke();
                ctx.closePath();
            }

            //Bottom
            if (bottomPaddle.lives > 2) {
                ctx.beginPath();
                ctx.arc(canvas.width/2 - 2*height, canvas.height - height, height/2, 0, Math.PI*2);
                ctx.fillStyle = bottomPaddle.colour;
                ctx.fill();
                ctx.stroke();
                ctx.closePath();

                ctx.beginPath();
                ctx.arc(canvas.width/2, canvas.height - height, height/2, 0, Math.PI*2);
                ctx.fillStyle = bottomPaddle.colour;
                ctx.fill();
                ctx.stroke();
                ctx.closePath();

                ctx.beginPath();
                ctx.arc(canvas.width/2 + 2*height, canvas.height - height, height/2, 0, Math.PI*2);
                ctx.fillStyle = bottomPaddle.colour;
                ctx.fill();
                ctx.stroke();
                ctx.closePath();
            }
            else if(bottomPaddle.lives > 1) {
                ctx.beginPath();
                ctx.arc(canvas.width/2 - height, canvas.height - height, height/2, 0, Math.PI*2);
                ctx.fillStyle = bottomPaddle.colour;
                ctx.fill();
                ctx.stroke();
                ctx.closePath();

                ctx.beginPath();
                ctx.arc(canvas.width/2 + height, canvas.height - height, height/2, 0, Math.PI*2);
                ctx.fillStyle = bottomPaddle.colour;
                ctx.fill();
                ctx.stroke();
                ctx.closePath();
            }
            else if(bottomPaddle.lives > 0) {
                ctx.beginPath();
                ctx.arc(canvas.width/2, canvas.height - height, height/2, 0, Math.PI*2);
                ctx.fillStyle = bottomPaddle.colour;
                ctx.fill();
                ctx.stroke();
                ctx.closePath();
            }
        }



        function bounce(ball) {
            var mySound = new Audio("Sounds/pop1.mp3");
            mySound.play();
            // if( ball.colour ==  "#000000") {
            //     ball.colour = "#FFFFFF";
            // }
            // else{
            //     ball.colour = "#000000";
            // }
        }

        function drawPaddle() {
            //bottom
            if(bottomPaddle.lives > 0) {
                ctx.beginPath();
                ctx.rect(bottomPaddle.x, canvas.height-borderWidth-paddleHeight, bottomPaddle.width, paddleHeight);
                ctx.fillStyle = bottomPaddle.colour;
                ctx.fill();
                ctx.closePath();

                ctx.beginPath();
                ctx.rect(bottomPaddle.x, canvas.height-borderWidth-paddleHeight, bottomPaddle.width, paddleHeight);
                ctx.stroke();
                ctx.closePath();
            }
            else {
                ctx.beginPath();
                ctx.rect(borderWidth + paddleHeight, canvas.height-borderWidth-paddleHeight, canvas.width - 2*borderWidth - 2*paddleHeight, paddleHeight);
                ctx.fillStyle = bottomPaddle.colour;
                ctx.fill();
                ctx.closePath();

                ctx.beginPath();
                ctx.rect(borderWidth + paddleHeight, canvas.height-borderWidth-paddleHeight, canvas.width - 2*borderWidth - 2*paddleHeight, paddleHeight);
                ctx.stroke();
                ctx.closePath();
            }
            

            //top
            if(topPaddle.lives > 0) {
                ctx.beginPath();
                ctx.rect(topPaddle.x, borderWidth, topPaddle.width, paddleHeight);
                ctx.fillStyle = topPaddle.colour;
                ctx.fill();
                ctx.closePath();

                ctx.beginPath();
                ctx.rect(topPaddle.x, borderWidth, topPaddle.width, paddleHeight);
                ctx.stroke();
                ctx.closePath();
            }
            else {
                ctx.beginPath();
                ctx.rect(borderWidth + paddleHeight, borderWidth, canvas.width - 2*borderWidth - 2*paddleHeight, paddleHeight);
                ctx.fillStyle = topPaddle.colour;
                ctx.fill();
                ctx.closePath();

                ctx.beginPath();
                ctx.rect(borderWidth + paddleHeight, borderWidth, canvas.width - 2*borderWidth - 2*paddleHeight, paddleHeight);
                ctx.stroke();
                ctx.closePath();
            }
            

            //left
            if(leftPaddle.lives > 0) {
                ctx.beginPath();
                ctx.rect(borderWidth, leftPaddle.y, paddleHeight, leftPaddle.width);
                ctx.fillStyle = leftPaddle.colour;
                ctx.fill();
                ctx.closePath();

                ctx.beginPath();
                ctx.rect(borderWidth, leftPaddle.y, paddleHeight, leftPaddle.width);
                ctx.stroke();
                ctx.closePath();
            }
            else {
                ctx.beginPath();
                ctx.rect(borderWidth, borderWidth + paddleHeight, paddleHeight, canvas.height - 2*borderWidth - 2*paddleHeight);
                ctx.fillStyle = leftPaddle.colour;
                ctx.fill();
                ctx.closePath();

                ctx.beginPath();
                ctx.rect(borderWidth, borderWidth + paddleHeight, paddleHeight, canvas.height - 2*borderWidth - 2*paddleHeight);
                ctx.stroke();
                ctx.closePath();
            }
            
            

            //right
            if(rightPaddle.lives > 0) {
                ctx.beginPath();
                ctx.rect(canvas.width - paddleHeight - borderWidth, rightPaddle.y, paddleHeight, rightPaddle.width);
                ctx.fillStyle = rightPaddle.colour;
                ctx.fill();
                ctx.closePath();

                ctx.beginPath();
                ctx.rect(canvas.width - paddleHeight - borderWidth, rightPaddle.y, paddleHeight, rightPaddle.width);
                ctx.stroke();
                ctx.closePath();
            }
            else {
                ctx.beginPath();
                ctx.rect(canvas.width - paddleHeight - borderWidth, borderWidth + paddleHeight, paddleHeight, canvas.height - 2*borderWidth - 2*paddleHeight);
                ctx.fillStyle = rightPaddle.colour;
                ctx.fill();
                ctx.closePath();

                ctx.beginPath();
                ctx.rect(canvas.width - paddleHeight - borderWidth, borderWidth + paddleHeight, paddleHeight, canvas.height - 2*borderWidth - 2*paddleHeight);
                ctx.stroke();
                ctx.closePath();
            }
        }
        

        function draw() {
            
            if(gameOver == false) {
                if(gameStarted == true) {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                if(randResizeToggle == true) {
                
                resizeCanvas();
                randResizeToggle = false;
                }

                //Show positions
                //document.getElementById("ballDx").innerHTML = Math.round(ball1.dx * 100) / 100;
                //document.getElementById("ballDy").innerHTML = Math.round(ball1.dy * 100) / 100;

                
                drawLives();
                drawPowerup(powerup1);
                drawPowerup(powerup2);

                powerupCollision(ball1, powerup1);
                powerupCollision(ball1, powerup2);

                


                drawBorder();
                drawBall(ball1);
                //drawBall(ball2);
                drawPaddle();

                // Paddle collision checks           
                //Bottom check
                bottomCollision(ball1);
                //bottomCollision(ball2);

                //Left check
                leftCollision(ball1);
                //leftCollision(ball2);

                //Top check
                topCollision(ball1);
                //topCollision(ball2);

                //Right  check
                rightCollision(ball1);
                //rightCollision(ball2);

                //Move paddles
                //Bottom player
                if(bottomPaddle.rightPress && bottomPaddle.x < canvas.width-bottomPaddle.width-borderWidth-paddleHeight) {
                    bottomPaddle.x += paddleSpeed;
                }
                else if(bottomPaddle.leftPress && bottomPaddle.x > borderWidth + paddleHeight) {
                    bottomPaddle.x -= paddleSpeed;
                    
                }

                //Top player
                if(topPaddle.rightPress && topPaddle.x < canvas.width-topPaddle.width-borderWidth-paddleHeight) {
                    //alert('here');
                    topPaddle.x += paddleSpeed;
                }
                else if(topPaddle.leftPress && topPaddle.x > borderWidth + paddleHeight) {               
                    topPaddle.x -= paddleSpeed;
                }

                //Left player
                if(leftPaddle.upPress && leftPaddle.y > borderWidth + paddleHeight) {  
                    leftPaddle.y -= paddleSpeed;
                }
                else if(leftPaddle.downPress && leftPaddle.y < canvas.height-leftPaddle.width-borderWidth-paddleHeight) {
                    leftPaddle.y += paddleSpeed;
                }

                //Right player
                if(rightPaddle.upPress && rightPaddle.y > borderWidth + paddleHeight) {
                    rightPaddle.y -= paddleSpeed;
                }
                else if(rightPaddle.downPress && rightPaddle.y < canvas.height-rightPaddle.width-borderWidth-paddleHeight) {
                    rightPaddle.y += paddleSpeed;
                }

                //Move ball1
                ball1.x += ball1.dx;
                ball1.y += ball1.dy;

                //Move ball2
                ball2.x += ball1.dx;
                ball2.y += ball2.dy;

                checkWinner();
                }
                
                

                }    
            requestAnimationFrame(draw);     
        }

        draw();


        /////////////////////////////////////////////////////// Collision Functions //////////////////////////////////////////////////////////////////

        function powerupCollision(ball, powerup) {
            //alert('here');
            
            if(ball.x + ball.dx > powerup.x - ballRadius
            && ball.x + ball.dx < powerup.x + powerup.size + ballRadius
            && ball.y + ball.dy > powerup.y - ballRadius
            && ball.y + ball.dy < powerup.y + powerup.size + ballRadius) {
                var player = ball.owner;
                //document.getElementById("status").innerHTML = "Powerup Owner: " + player;
                var mySound = new Audio("Sounds/collect.mp3");
                mySound.play();
                powerup.active = false;
                givePowerup(ball);
                drawPowerup(powerup);
                ball.owner = 'none';
            }
        }


        function bottomCollision(ball) {
            if(ball.y + ball.dy > canvas.height-borderWidth-ballRadius-paddleHeight) { 
                if(bottomPaddle.lives == 0) {
                    ball.dy = -ball.dy;
                    //document.getElementById("status").innerHTML = "Bottom Paddle: Wall";
                    bounce(ball); 
                }

                //Check if ball has collided with paddle
                if(ball.x + ball.dx > bottomPaddle.x - ballRadius
                && ball.x + ball.dx < bottomPaddle.x + bottomPaddle.width + ballRadius
                && ball.y + ball.dy < canvas.height - borderWidth + ballRadius)
                {
                    ball.owner = 'bottom';
                    //Check if it rebounds on top
                    if(ball.x + ball.dx > bottomPaddle.x - (ballRadius/2) 
                        && ball.x + ball.dx < bottomPaddle.x + bottomPaddle.width + (ballRadius/2) 
                        && ball.y + ball.dy < canvas.height - borderWidth - paddleHeight) {
                        //Ball direction should only change once
                        if(Math.sign(ball.dy) == 1)
                        {
                            if(relativeAngleReboundToggle == true) {
                                if(ball.x < bottomPaddle.x + bottomPaddle.width/2) {    //Left side of paddle
                                    var angleMultiplier = (ball.x - (bottomPaddle.x - ballRadius/2))/(bottomPaddle.width/2 + ballRadius/2);
                                    var angle = angleMultiplier * (Math.PI/2);
                                    //document.getElementById("status").innerHTML = angleMultiplier;
                                    ball.dy = -(speedRatio * Math.sin(angle));
                                    var sign = Math.sign(ball.dx);
                                    if(sign == 0) sign = -1; 
                                    ball.dx = sign * (speedRatio * Math.cos(angle));
                                    bounce(ball);
                                }
                                else if (ball.x > bottomPaddle.x + bottomPaddle.width/2) {  //Right side of paddle
                                    var angleMultiplier = 1-(ball.x - (bottomPaddle.x + bottomPaddle.width/2))/(bottomPaddle.width/2 + ballRadius/2);
                                    var angle = angleMultiplier * (Math.PI/2);
                                    //document.getElementById("status").innerHTML = angleMultiplier;
                                    ball.dy = Math.round(-(speedRatio * Math.sin(angle)));
                                    var sign = Math.sign(ball.dx);
                                    if(sign == 0) sign = 1;
                                    ball.dx = Math.round(sign * (speedRatio * Math.cos(angle)));
                                    bounce(ball);
                                }
                                else {  //Unlikely occurance of it being perfectly in the middle
                                    ball.dy = -speedRatio
                                    ball.dx = 0;
                                    bounce(ball);
                                }
                            }
                            else {
                                ball.dy = -ball.dy;
                                //document.getElementById("status").innerHTML = "Bottom Paddle: Top";
                                bounce(ball);
                            }
                            
                        }
                    }
                    else{
                        //Left side
                        if(ball.x + ball.dx > bottomPaddle.x - ballRadius && ball.x + ball.dx < bottomPaddle.x) {
                            //document.getElementById("status").innerHTML = "Bottom Paddle: Left";
                            if(Math.sign(ball.dx) == 1) {
                                ball.dx = -ball.dx;
                                bounce(ball);
                            }                            
                        }
                        //Right side
                        else if(ball.x + ball.dx < bottomPaddle.x + bottomPaddle.width + ballRadius && ball.x + ball.dx > bottomPaddle.x + bottomPaddle.width) {
                            //document.getElementById("status").innerHTML = "Bottom Paddle: Right";
                            if(Math.sign(ball.dx) == -1) {
                                ball.dx = -ball.dx;
                                bounce(ball);
                            } 
                        }
                    }
                    
                    
                }
                //Otherwise player missed
                else{
                    if(ball.y > canvas.height) {
                        //Take off a life
                        bottomPaddle.lives--;
                        if(bottomPaddle.lives == 0) {
                            var mySound = new Audio("Sounds/dead.mp3");
                            mySound.play();
                        }
                        else {
                            var mySound = new Audio("Sounds/looseLife.mp3");
                            mySound.play();
                        }

                        //Reset ball
                        ball.initialPos = true;

                        ball.x = canvas.width/2;
                        ball.y = canvas.height*4/5;
                        ball.dx = 0;
                        ball.dy = -speedRatio;
                    //bottomPaddleX = (canvas.width-paddleWidth)/2;
                    }
                }
            }
        }        

        function rightCollision(ball) {
            if(ball.x + ball.dx > canvas.height-borderWidth-ballRadius-paddleHeight) { 
                if(rightPaddle.lives == 0) {
                    ball.dx = -ball.dx;
                    //document.getElementById("status").innerHTML = "Right Paddle: Wall";
                    bounce(ball);
                }

                //Check if ball has collided with paddle
                if(ball.y + ball.dy > rightPaddle.y - ballRadius
                && ball.y + ball.dy < rightPaddle.y + rightPaddle.width + ballRadius
                && ball.x + ball.dx < canvas.height - borderWidth + ballRadius)
                {
                    ball.owner = 'right';
                    //Check if it rebounds left side
                    if(ball.y + ball.dy > rightPaddle.y - (ballRadius/2) 
                        && ball.y + ball.dy < rightPaddle.y + rightPaddle.width + (ballRadius/2) 
                        && ball.x + ball.dx < canvas.height - borderWidth - paddleHeight) {
                        //Ball direction should only change once
                        if(Math.sign(ball.dx) == 1)
                        {
                            if(relativeAngleReboundToggle == true) {
                                if(ball.y < rightPaddle.y + rightPaddle.width/2) {     //Top half of paddle
                                    var angleMultiplier = (ball.y - (rightPaddle.y - ballRadius/2)) / (rightPaddle.width/2 + ballRadius/2);
                                    var angle = angleMultiplier * (Math.PI/2);
                                    //document.getElementById("status").innerHTML = angleMultiplier;
                                    ball.dx = -(speedRatio * Math.sin(angle));
                                    var sign = Math.sign(ball.dy);
                                    if(sign == 0) sign = -1;
                                    ball.dy = sign * (speedRatio * Math.cos(angle));
                                    bounce(ball);
                                }
                                else if(ball.y > rightPaddle.y + rightPaddle.width/2) {   //Bottom half of paddle
                                    var angleMultiplier = 1-((ball.y - (rightPaddle.y + rightPaddle.width/2)) / (rightPaddle.width/2 + ballRadius/2));
                                    var angle = angleMultiplier * (Math.PI/2);
                                    //document.getElementById("status").innerHTML = angleMultiplier;
                                    ball.dx = -(speedRatio * Math.sin(angle));
                                    var sign = Math.sign(ball.dy);
                                    if(sign == 0) sign = 1;
                                    ball.dy = sign * (speedRatio * Math.cos(angle));
                                    bounce(ball);
                                }
                                else {
                                    ball.dy = 0;
                                    ball.dx = -speedRatio;
                                    bounce(ball);
                                }
                            }
                            else {
                                ball.dx = -ball.dx;
                                //document.getElementById("status").innerHTML = "Right Paddle: Side";
                                bounce(ball);
                            }
                            
                        }
                    }
                    else{
                        //Top side
                        if(ball.y + ball.dy > rightPaddle.y - ballRadius && ball.y + ball.dy < rightPaddle.y) {
                            //document.getElementById("status").innerHTML = "Right Paddle: Top";
                            if(Math.sign(ball.dy) == 1) {
                                ball.dy = -ball.dy;
                                bounce(ball);
                            }                            
                        }
                        //Bottom side
                        else if(ball.y + ball.dy < rightPaddle.y + rightPaddle.width + ballRadius && ball.y + ball.dy > rightPaddle.y + rightPaddle.width) {
                            //document.getElementById("status").innerHTML = "Right Paddle: Bottom";
                            if(Math.sign(ball.dy) == -1) {
                                ball.dy = -ball.dy;
                                bounce(ball);
                            } 
                        }
                    }
                    
                    
                }
                //Otherwise player missed
                else{
                    if(ball.x > canvas.height) {
                        //Take off a life
                        rightPaddle.lives--;
                        if(rightPaddle.lives == 0) {
                            var mySound = new Audio("Sounds/dead.mp3");
                            mySound.play();
                        }
                        else {
                            var mySound = new Audio("Sounds/looseLife.mp3");
                            mySound.play();
                        }

                        //Reset ball
                        ball.initialPos = true;

                        ball.x = canvas.width/2;
                        ball.y = canvas.height*4/5;
                        ball.dx = 0;
                        ball.dy = -speedRatio;
                    //bottomPaddleX = (canvas.width-paddleWidth)/2;
                    }
                }
            }
        } 
        
        function leftCollision(ball) {
            if(ball.x + ball.dx < borderWidth + paddleHeight + ballRadius) {    
                if(leftPaddle.lives == 0) {
                    ball.dx = -ball.dx;
                    bounce(ball);
                    //document.getElementById("status").innerHTML = "Left Paddle: Wall";
                }           

                //Check if ball has collided with paddle
                if(ball.y + ball.dy > leftPaddle.y - ballRadius
                && ball.y + ball.dy < leftPaddle.y + leftPaddle.width + ballRadius
                && ball.x + ball.dx > borderWidth - ballRadius) 
                { 
                    ball.owner = 'left';
                    //Check if it rebounds on right side
                    if(ball.y + ball.dy > leftPaddle.y - (ballRadius/2)
                    && ball.y + ball.dy < leftPaddle.y + leftPaddle.width + (ballRadius/2)
                    && ball.x + ball.dx > borderWidth + paddleHeight)
                    {
                        if(Math.sign(ball.dx) == -1)
                        {
                            if(relativeAngleReboundToggle == true) {
                                if(ball.y < leftPaddle.y + leftPaddle.width/2) {      //Top half of paddle
                                    var angleMultiplier = (ball.y - (leftPaddle.y - ballRadius/2)) / (leftPaddle.width/2 + ballRadius/2);
                                    var angle = angleMultiplier * (Math.PI/2);
                                    //document.getElementById("status").innerHTML = angleMultiplier;
                                    ball.dx = (speedRatio * Math.sin(angle));
                                    var sign = Math.sign(ball.dy);
                                    if(sign == 0) sign = -1;
                                    ball.dy = sign * (speedRatio * Math.cos(angle));
                                    bounce(ball);
                                }
                                else if(ball.y > leftPaddle.y + leftPaddle.width/2) {   //Bottom half of paddle
                                    var angleMultiplier = 1-((ball.y - (leftPaddle.y + leftPaddle.width/2)) / (leftPaddle.width/2 + ballRadius/2));
                                    var angle = angleMultiplier * (Math.PI/2);
                                    //document.getElementById("status").innerHTML = angleMultiplier;
                                    ball.dx = (speedRatio * Math.sin(angle));
                                    var sign = Math.sign(ball.dy);
                                    if(sign == 0) sign = 1;
                                    ball.dy = sign * (speedRatio * Math.cos(angle));
                                    bounce(ball);
                                }
                                else {
                                    ball.dy = 0;
                                    ball.dx = -speedRatio;
                                    bounce(ball);
                                }
                            }
                            else {
                                ball.dx = -ball.dx;
                                bounce(ball);
                                //document.getElementById("status").innerHTML = "Left Paddle: Side";
                            }
                            
                        }
                    }
                    else {
                        //Top
                        if(ball.y + ball.dy > leftPaddle.y - ballRadius && ball.y + ball.dy < leftPaddle.y) {
                            if(Math.sign(ball.dy) == 1)
                            {
                                ball.dy = -ball.dy;
                                bounce(ball);
                                //document.getElementById("status").innerHTML = "Left Paddle: Top";
                            }                            
                        }
                        //Bottom
                        else if(ball.y + ball.dy < leftPaddle.y + leftPaddle.width + ballRadius && ball.y + ball.dy > leftPaddle.y + leftPaddle.width) {
                            if(Math.sign(ball.dy) == -1)
                            {
                                ball.dy = -ball.dy;
                                bounce(ball);
                                //document.getElementById("status").innerHTML = "Left Paddle: Bottom";
                            }
                        }

                    }

                }
                // Otherwise player missed
                else {
                    if(ball.x < 0) {
                        //Take off a life
                        leftPaddle.lives--;
                        if(leftPaddle.lives == 0) {
                            var mySound = new Audio("Sounds/dead.mp3");
                            mySound.play();
                        }
                        else {
                            var mySound = new Audio("Sounds/looseLife.mp3");
                            mySound.play();
                        }

                        //Reset ball
                        ball.initialPos = true;

                        ball.x = canvas.width/2;
                        ball.y = canvas.height*4/5;
                        ball.dx = 0;
                        ball.dy = -speedRatio;
                    //bottomPaddleX = (canvas.width-paddleWidth)/2;
                    }                   
                }               
            }
        }

        function topCollision(ball) {
            if(ball.y + ball.dy < borderWidth + paddleHeight + ballRadius) {
                if(topPaddle.lives == 0) {
                    ball.dy = -ball.dy;
                    bounce(ball);
                    //document.getElementById("status").innerHTML = "Top Paddle: Wall";
                }
                
                //Check if ball has collided with paddle
                if(ball.x + ball.dx > topPaddle.x - ballRadius
                && ball.x + ball.dx < topPaddle.x + topPaddle.width + ballRadius
                && ball.y + ball.dy > borderWidth - ballRadius) 
                { 
                    //alert(topPaddle.x);
                    ball.owner = 'top';
                    //Check if it rebounds on bottom
                    if(ball.x + ball.dx > topPaddle.x - (ballRadius/2)
                    && ball.x + ball.dx < topPaddle.x + topPaddle.width + (ballRadius/2)
                    && ball.y + ball.dy > borderWidth + paddleHeight)
                    {
                        
                        if(Math.sign(ball.dy) == -1)
                        {
                            if(relativeAngleReboundToggle == true) {
                                if(ball.x < topPaddle.x + topPaddle.width/2) {    //Left side of paddle
                                    var angleMultiplier = (ball.x - (topPaddle.x - ballRadius/2))/(topPaddle.width/2 + ballRadius/2);
                                    var angle = angleMultiplier * (Math.PI/2);
                                    //document.getElementById("status").innerHTML = angleMultiplier;
                                    ball.dy = (speedRatio * Math.sin(angle));
                                    var sign = Math.sign(ball.dx);
                                    if(sign == 0) sign = -1; 
                                    ball.dx = sign * (speedRatio * Math.cos(angle));
                                    bounce(ball);
                                }
                                else if (ball.x > topPaddle.x + topPaddle.width/2) {  //Right side of paddle
                                    var angleMultiplier = 1-(ball.x - (topPaddle.x + topPaddle.width/2))/(topPaddle.width/2 + ballRadius/2);
                                    var angle = angleMultiplier * (Math.PI/2);
                                    //document.getElementById("status").innerHTML = angleMultiplier;
                                    ball.dy = (speedRatio * Math.sin(angle));
                                    var sign = Math.sign(ball.dx);
                                    if(sign == 0) sign = 1;
                                    ball.dx = sign * (speedRatio * Math.cos(angle));
                                    bounce(ball);
                                }
                                else {  //Unlikely occurance of it being perfectly in the middle
                                    ball.dy = -speedRatio
                                    ball.dx = 0;
                                    bounce(ball);
                                }
                            }
                            else {
                                ball.dy = -ball.dy;
                                bounce(ball);
                                //document.getElementById("status").innerHTML = "Top Paddle: Bottom";
                            }
                            
                        }
                    }
                    else {
                        //Top
                        if(ball.x + ball.dx > topPaddle.x - ballRadius && ball.x + ball.dx < topPaddle.x) {
                            if(Math.sign(ball.dx) == 1)
                            {
                                ball.dx = -ball.dx;
                                bounce(ball);
                                //document.getElementById("status").innerHTML = "Top Paddle: Left";
                            }                            
                        }
                        //Bottom
                        else if(ball.x + ball.dx < topPaddle.x + topPaddle.width + ballRadius && ball.x + ball.dx > topPaddle.x + topPaddle.width) {
                            if(Math.sign(ball.dx) == -1)
                            {
                                ball.dx = -ball.dx;
                                bounce(ball);
                                //document.getElementById("status").innerHTML = "Top Paddle: Right";
                            }
                        }

                    }

                }
                // Otherwise player missed
                else {
                    if(ball.y < 0) {
                        //Take off a life
                        topPaddle.lives--;
                        if(topPaddle.lives == 0) {
                            var mySound = new Audio("Sounds/dead.mp3");
                            mySound.play();
                        }
                        else {
                            var mySound = new Audio("Sounds/looseLife.mp3");
                            mySound.play();
                        }

                        //Reset ball
                        ball.initialPos = true;

                        ball.x = canvas.width/2;
                        ball.y = canvas.height*4/5;
                        ball.dx = 0;
                        ball.dy = -speedRatio;
                    //bottomPaddleX = (canvas.width-paddleWidth)/2;
                    }                   
                }               
            }
        }
    </script>

</body>
</html>
